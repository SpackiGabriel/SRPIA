{% extends 'base.html' %}

{% block title %}Tags - SRPIA{% endblock %}

{% block extra_css %}
<style>
.tag-card {
    position: relative;
    padding: var(--space-4);
    background: var(--surface-elevated);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-lg);
    transition: all var(--transition-normal);
    cursor: pointer;
    overflow: hidden;
}

.tag-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--color-primary-500);
    transform: scaleY(0);
    transition: transform var(--transition-normal);
}

.tag-card:hover {
    border-color: var(--color-primary-500);
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
}

.tag-card:hover::before {
    transform: scaleY(1);
}

.tag-icon-wrapper {
    width: 36px;
    height: 36px;
    background: var(--color-primary-50);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-normal);
}

.tag-card:hover .tag-icon-wrapper {
    background: var(--color-primary-100);
    transform: scale(1.1);
}

.tag-count-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1) var(--space-2);
    background: var(--surface-hover);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
}

.tag-card:hover .tag-count-badge {
    background: var(--color-primary-50);
    color: var(--color-primary-700);
}

.tag-actions {
    opacity: 0;
    transition: opacity var(--transition-fast);
}

.tag-card:hover .tag-actions {
    opacity: 1;
}

@media (max-width: 768px) {
    .grid-cols-3 {
        grid-template-columns: 1fr !important;
    }
    
    .tag-actions {
        opacity: 1;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
            <h1 class="page-title">Minhas Tags</h1>
            <p class="page-subtitle">Organize seus papers por tags temáticas</p>
        </div>
        <a href="{% url 'tag_create' %}" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i>
            Nova Tag
        </a>
    </div>
</div>

<!-- Tags List -->
{% if tags %}
<div class="section">
    <div class="section-header" style="margin-bottom: var(--space-4);">
        <h2 class="section-title">
            <i class="bi bi-tags"></i>
            Tags
        </h2>
        <span class="text-sm text-secondary">{{ tags|length }} tag(s) cadastrada(s)</span>
    </div>

    <!-- Tags Grid -->
    <div class="grid grid-cols-3" style="gap: var(--space-4);">
        {% for tag in tags %}
        <div class="tag-card" onclick="{% if tag.paper_count > 0 %}window.location='{% url 'paper_list' %}?tag={{ tag.id }}'{% endif %}">
            <!-- Header -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                <div style="display: flex; align-items: center; gap: var(--space-2); flex: 1;">
                    <div class="tag-icon-wrapper">
                        <i class="bi bi-tag-fill" style="font-size: 18px; color: var(--color-primary-600);"></i>
                    </div>
                    <h3 class="heading-sm" style="margin: 0; color: var(--text-primary);">{{ tag.name }}</h3>
                </div>
                
                <!-- Actions (show on hover) -->
                <div class="tag-actions" style="display: flex; gap: var(--space-1);">
                    <a href="{% url 'tag_delete' tag.pk %}" 
                       onclick="event.stopPropagation();"
                       class="btn btn-ghost btn-sm" 
                       style="color: var(--color-danger-600); padding: var(--space-1);">
                        <i class="bi bi-trash"></i>
                    </a>
                </div>
            </div>

            <!-- Info -->
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <span class="tag-count-badge">
                    <i class="bi bi-files"></i>
                    <span>{{ tag.paper_count }} paper{{ tag.paper_count|pluralize }}</span>
                </span>
                
                {% if tag.paper_count > 0 %}
                <a href="{% url 'paper_list' %}?tag={{ tag.id }}" 
                   onclick="event.stopPropagation();"
                   class="btn btn-ghost btn-sm"
                   style="padding: var(--space-1) var(--space-2);">
                    <i class="bi bi-arrow-right"></i>
                </a>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Tags Info Card -->
<div class="section">
    <div class="card" style="border-left: 3px solid var(--color-primary-500);">
        <div class="card-body" style="display: flex; gap: var(--space-4); align-items: center;">
            <div style="width: 48px; height: 48px; background: var(--color-primary-100); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <i class="bi bi-lightbulb" style="font-size: 24px; color: var(--color-primary-600);"></i>
            </div>
            <div>
                <h4 class="heading-sm" style="margin-bottom: var(--space-1); color: var(--text-primary);">
                    Dica sobre Tags
                </h4>
                <p class="text-sm text-secondary" style="margin: 0;">
                    Use tags para organizar seus papers por temas, áreas de pesquisa ou qualquer categorização que faça sentido para você. 
                    Tags facilitam a busca e organização da sua biblioteca.
                </p>
            </div>
        </div>
    </div>
</div>

{% else %}
<!-- Empty State -->
<div class="empty-state">
    <div class="empty-state-icon">
        <i class="bi bi-tags"></i>
    </div>
    <h3 class="empty-state-title">Nenhuma tag cadastrada</h3>
    <p class="empty-state-text">
        Crie tags para organizar seus papers por temas,<br>
        áreas de pesquisa ou qualquer categorização útil.
    </p>
    <a href="{% url 'tag_create' %}" class="btn btn-primary">
        <i class="bi bi-plus-circle"></i>
        Criar Primeira Tag
    </a>
</div>

<!-- Getting Started Guide -->
<div class="section">
    <div class="card">
        <div class="card-body" style="padding: var(--space-8);">
            <h3 class="heading-lg" style="text-align: center; margin-bottom: var(--space-6);">
                Como usar Tags
            </h3>
            <div class="grid grid-cols-3" style="gap: var(--space-6);">
                <div style="text-align: center;">
                    <div style="width: 64px; height: 64px; background: var(--color-primary-50); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-4);">
                        <i class="bi bi-plus-circle" style="font-size: 32px; color: var(--color-primary-600);"></i>
                    </div>
                    <h4 class="heading-sm" style="margin-bottom: var(--space-2);">1. Crie Tags</h4>
                    <p class="text-sm text-secondary">
                        Defina categorias como "Machine Learning", "NLP", "Computer Vision"
                    </p>
                </div>
                <div style="text-align: center;">
                    <div style="width: 64px; height: 64px; background: var(--color-success-50); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-4);">
                        <i class="bi bi-link-45deg" style="font-size: 32px; color: var(--color-success-600);"></i>
                    </div>
                    <h4 class="heading-sm" style="margin-bottom: var(--space-2);">2. Adicione aos Papers</h4>
                    <p class="text-sm text-secondary">
                        Associe tags relevantes ao criar ou editar papers
                    </p>
                </div>
                <div style="text-align: center;">
                    <div style="width: 64px; height: 64px; background: var(--color-warning-50); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-4);">
                        <i class="bi bi-search" style="font-size: 32px; color: var(--color-warning-600);"></i>
                    </div>
                    <h4 class="heading-sm" style="margin-bottom: var(--space-2);">3. Filtre e Organize</h4>
                    <p class="text-sm text-secondary">
                        Use tags para filtrar papers por tema na listagem
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
